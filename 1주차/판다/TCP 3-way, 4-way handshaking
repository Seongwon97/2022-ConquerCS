# TCP 3-way / 4-way handshake

- TCP는 대용량의 데이터를 세그먼트 단위로 쪼개서 전송
- 데이터의 신뢰성을 담보하기 위해 3-way handshaking을 통해 연결 생성
- 통신 종료 후 4-way handshaking을 통해 연결 해제


## 3 way handshaking

1) 클라이언트는 서버에게 SYN 플래그와 함께 패킷을 전송
2) 서버는 클라이언트에게 SYN/ACK 플래그와 함께 패킷 수신 사실을 전송
3) 클라이언트가 서버에게 ACK 플래그를 보냄으로서 연결 성립

- 과정 중에 통신이 끊어지면 TCP는 다시 같은 수순을 반복


## 4 way handshaking

1) 클라이언트가 서버에게 FIN 플래그와 함께 패킷을 전송
2) 서버는 ACK 플래그와 함께 패킷을 전송한 뒤, 데이터 전송이 끝날 때 까지 대기
3) 전송이 끝나면 FIN 플래그와 함께 클라이언트에게 패킷을 전송
4) 클라이언트가 서버에게 ACK 플래그를 보냄으로서 연결 해제


## 플래그 정보
 
- TCP 헤더에는 6 digit의 플래그 비트가 존재.
- 각각의 비트는 URG-ACK-PSH-RST-SYN-FIN 의 의미
- ex) 000010 : SYN, 010000 : ACK, 000001 : FIN


## 왜 연결 생성은 3-way 이고, 연결 해제는 4-way 일까?
- 클라이언트가 데이터 전송을 마쳤어도, 서버는 아직 전송할 데이터가 남아있을 수 있기 때문
- 서버는 일단 클라이언트의 FIN 플래그에 대한 응답으로 ACK를 보내고, 자신의 데이터를 모두 전송한 후 FIN을 전송

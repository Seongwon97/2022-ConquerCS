# **프로토콜(Protocol)**

컴퓨터와 네트워크 기기가 상호 간에 통신하기 위해서는 서로 같은 방법으로 통신해야 한다.

- ex) 어떻게 상대를 찾고, 어떻게 상대에게 이야기하고, 어떠한 언어로 이야기를 하며, 어떻게 이야기를 종료할까 와 같은 규칙

이렇게 **서로 다른 하드웨어와 운영체제를 가지고 서로 통신을 하기 위해서는 모든 요소에 규칙이 필요한데, 이러한 규칙을 프로토콜**이라고 한다.

## **IP(Internet Protocol)**

> 인터넷 환경에서의 통신 규약
>
- 패킷이라는 통신 단위로 데이터를 전달하며, 지정한 IP주소로 데이터를 전달
- 패킷을 받는 대상이 존재하는지, 패킷이 올바르게 전달됐는지 확인하지 않아 **비 연결성과 비 신뢰성**의 특징을 갖고 있다.
- 일반적으로 TCP와 IP를 함께 사용하는데, IP가 데이터의 배달을 처리한다면 TCP는 패킷을 추적 및 관리한다.

---

# TCP와 UDP는 왜 나오게 됐는가?

1. IP의 역할은 Host to Host (장치 to 장치)만을 지원한다.
    - 장치 → 장치의 이동 = IP로 해결
    - 하나의 장비내의 수많은 프로그램들이 통신을 할 경우에는 IP만으로는 한계가 있다.

   → 해결을 위해 **포트 번호**가 생겨남!

2. 또한, IP에서 오류가 발생한다면 ICMP에서 알려준다. 하지만 ICMP는 알려주기만 할 뿐 대처를 못하기 때문에 IP보다 위에서 처리를 해줘야 한다.

   → 해결을 위해 TCP, UPD가 생겨남!


> ICMP : 인터넷 제어 메시지 프로토콜로 네트워크 컴퓨터 위에서 돌아가는 운영체제에서 오류 메시지를 전송받는데 주로 쓰임
>

### **TCP & UDP의 오류 해결법**

### **TCP**

- 데이터의 분실, 중복, 순서가 뒤바뀜 등을 자동으로 보정해 송수신 데이터의 정확한 전달을 할 수 있도록 해준다.

### **UDP**

- IP가 제공하는 정도의 수준만을 제공하는 간단한 IP 상위 계층의 프로토콜
- TCP와는 다르게 에러가 날 수도 있고, 재전송이나 순서가 뒤바뀔 수도 있어서 이 경우, 어플리케이션에서 처리하는 번거로움이 존재한다.

---

# **TCP(Transmission Control Protocol)**

> 클라이언트와 서버가 연결된 상태에서 데이터를 주고받는 **연결 지향적 프로토콜**
>

### 특징

- **신뢰성 있는 데이터 전송을 지원하는 연결 지향형 프로토콜**
- **3-way handshake**(연결 설정), **4-way handshake**(연결 해제) 사용
- **흐름 제어, 혼잡 제어, 오류 제어를 통해 신뢰성을 보장**.
- **데이터의 전송 순서를 보장**하며 수신 여부를 확인할 수 있다.

### 단점

- UDP보다 전송 속도가 느리다
- 데이터로 보내기 전에 반드시 연결이 형성 되어야 한다
- 1 : 1 통신만 가능하다.

**패킷(Packet)?**

> 인터넷 내에서 데이터를 보내기 위한 경로 배정(라우팅)을 효율적으로 하기 위해서 데이터를 여러 개의 조각으로 나누어 전송을 하는데, 이때 조각을 패킷이라고 한다.
>

### 신뢰성 있는 네트워크를 보장하기 위해 해결해야 할 문제

1. **손실** : packet이 손실될 수 있는 문제
2. **순서 바뀜** : packet의 순서가 바뀌는 문제
3. **Congestion** : 네트워크가 혼잡한 문제
4. **Overload** : receiver가 overload 되는 문제

***→ TCP 혼잡제어 & 흐름제어 확인!***

---

# UDP

## UDP란?

> User Datagram Protocol의 약자로 데이터를 데이터그램 단위로 처리하는 프로토콜
>
- 전송 계층의 **비연결성, 신뢰성 없는 전송 프로토콜**
- 데이터그램 단위로 쪼개면서 전송을 해야하기 때문에 전송 계층이다.

## UDP를 왜 사용할까?

- 결정적인 장점은 **데이터의 신속성**
    - TCP는 신뢰성을 보장하지만 연결을 통해 시간 손실을 발생할수 있다.
    - TCP는 패킷이 누락되면 재전송을 해야 한다.
- 사용 예시
    - 사진 또는 영상, 스트리밍 →  데이터의 일부가 누락돼도 문제가 발생하지 않음
    - DNS에서 UDP를 사용하는 이유
        - Request의 양이 작으므로 UDP Request에 담길 수 있다.
        - 3 way handshaking으로 연결을 유지할 필요가 없다. (오버헤드 발생)
        - Request에 대한 손실은 Application Layer에서 제어가 가능하다.
        - 그러나, 크기가 512(UDP 제한)이 넘을 때는 TCP를 사용해야한다.

## UDP의 특징

- 비 연결형 서비스로 연결 없이 통신이 가능하며 데이터그램 방식을 제공한다.
- 정보를 주고 받을 때, 정보를 보내거나 받는다는 신호 절차를 거치지 않는다.
- 신뢰성 없는 데이터를 전송한다.
- 패킷 관리가 필요하다.
- 패킷 오버헤드가 적어 네트워크 부하가 감소된다.
- 상대적으로 TCP보다 전송속도가 빠르다.

### 단점

- 데이터의 신뢰성이 없다.
- TCP와는 다르게 데이터를 쪼개주지 않아 애플리케이션 단에서 패킷을 쪼개야 한다.

---

# **TCP와 UDP 비교**

## **공통점**

- 포트 번호를 이용하여 주소를 지정함
- 데이터 오류 검사를 위한 체크섬이 존재함

## **차이점**

![https://user-images.githubusercontent.com/55661631/143240402-81093a61-800f-459f-b2ac-5ee0a5089eb4.png](https://user-images.githubusercontent.com/55661631/143240402-81093a61-800f-459f-b2ac-5ee0a5089eb4.png)

### 질문
- 유튜브와 같은 스트리밍 서비스를 제작해보려합니다. 이때 어떤 프로토콜로 구현할 것인지 관련 계층과 연관지어 말해주세요.
  - 스트리밍에서는 연속성이 중요하기 때문에 신뢰도는 낮지만 빠른 4계층 transport layer의 `UDP 프로토콜`을 사용하여 구현하겠습니다.
- 
# 트랜잭션

## 트랜잭션이란?

데이터베이스의 상태를 변화시키기위해 수행하는 작업의 단위

## 트랜잭션의 특징

- 원자성
    - 트랜잭션이 DB에 모두 반영되거나, 혹은 모두 반영되지 않는다.
- 일관성
    - 트랜잭션의 작업 처리 결과는 항상 동일하다.
- 독립성
    - 둘 이상의 트랜잭션에 동시에 실행될 때, 서로 다른 트랜잭션의 연산에 영향을 주지 않는다.
- 지속성
    - 트랜잭션의 완료 후 결과는 영구적으로 반영된다.

## TPS ( Transaction Per Second )

: 초당 트랜잭션 수

- 1초에 실행되고있는 트랜잭션의 수
- 얼마나 실행되고 있는지, 에러율은 얼마인지 등 애플리케이션 성능을 측정할 때 중요한 지표로 쓰인다.

## commit

트랜잭션이 수행될 때 원본 DB에 바로 수행하는 것이 아니라 변경 부분을 복사하여 메모리에서 진행하고, 트랜잭션이 정상적으로 수행되면 그때 원본 DB에 적용한다. 이를 commit이라고 한다!
즉, 하나의 트랜잭션이 성공적으로 끝났음을 알려주는 연산!

## rollback

트랜잭션 과정에서 처리가 비정상적으로 종료된 경우 메모리에서 하고있던 작업을 commit 하지 않고 메모리에서 삭제해버린다. 따라서 원본 DB가 트랜잭션 처리 전과 동일한 상태가 된다. 이를 rollback이라고
한다!

## 트랜잭션 격리수준

- READ UNCOMMITED
    - 각 트랜잭션에서의 변경이 다른 트랜잭션에게도 모두 공개
    - 성능은 제일 좋으나 정합성에 문제가 많아 잘 사용되지 않는다.
- READ COMMITED
    - commit 완료된 데이터만 다른 트랜잭션에서 조회 가능
    - 한 트랜잭션 내에서 동일한 select 쿼리시 항상 같은 결과를 보장하지 않는다 → non-repeatable read
    - 오라클의 기본 설정
- REPEATABLE READ
    - 자신의 트랜잭션 번호보다 낮은 트랜잭션 번호에서 커밋된 것만 조회 가능
    - 트랜잭션이 시작한 시점으로부터 이후에 커밋된 내용은 반영하지 않기 때문에 select시 항상 같은 결과를 보장한다. → repeatable read
    - MySQL의 기본설정
- SERIALIZABLE
    - select에까지 모두 공유 잠금을 설정함으로써 엄격하게 격리를 유지한다.
    - 성능저하가 발생할 수 있다.

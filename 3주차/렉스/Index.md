# Index
- Index란 추가적인 쓰기 작업과 저장 공간을 활용하여 데이터베이스 테이블의 검색 속도를 향상시키기 위한 자료구조이다.
- 인덱스가 무엇인지에 대해 이해하기 쉽게 설명하자면, 인덱스는 책의 목차와 같다고 생각하면 된다. 해당 목차가 없다면 특정 내용을 찾기 위해 책의 모든 내용을 봐야하는데, 책의 목차를 통해 우리는 탐색 범위를 줄일 수 있다.
- DB의 인덱스는 책의 목차와 같은 역할을 하여 DB의 데이터를 조회할 때 속도 향상에 도움을 준다.
    - Table의 Full Scan을 하지 않아도 된다.
- B+ tree 구조로 Index 파일을 검색하여 검색 속도를 향상했다.

## **과정**

Table을 생성하면, **MYD, MYI, FRM** 3개의 파일이 생성된다.

- FRM : 테이블 구조가 저장되어 있는 파일
- MYD : 실제 데이터가 있는 파일
- MYI : Index 정보가 들어가 있는 파일

Index를 사용하지 않는 경우, MYI 파일은 비어져 있으나 인덱싱하는 경우 MYI 파일이 생성된다. **이후에 사용자가 Select 쿼리로** Index를 사용하는 Column을 탐색 시, MYI 파일의 내용을 검색한다.

## 인덱스의 장점과 단점

### 장점

- 테이블을 조회하는 속도와 그에 따른 성능을 향상시킬 수 있다.
- 전반적인 시스템의 부하를 줄일 수 있다.

### 단점

- Index 생성시, .mdb 파일 크기가 증가함
    - 인덱스를 관리하기 위해 DB의 약 10%에 해당하는 저장공간이 필요한다.
- 인덱스를 관리하기 위해 추가 작업이 필요하다
    - 인덱스 된 Field에서 Data를 업데이트하거나, Record를 추가 또는 삭제시 성능이 떨어진다.
    - 데이터 변경 작업이 자주 일어나는 경우, Index를 재작성해야 하므로, 성능에 영향을 미침.
- 인덱스를 잘못 선택할 경우 오히려 성능이 저하되는 역효과가 발생할 수 있다.
- 한 페이지를 동시에 수정할 수 있는 병행성이 줄어든다.

## 상황분석

### 인덱스를 사용하면 좋은 경우

- 규모가 작지 않은 테이블
- INSERT, UPDATE, DELETE가 자주 발생하지 않는 Column
- JOIN이나 WHERE 또는 ORDER BY에 자주 사용되는 Column
- 외래키가 사용되는 Column
- 데이터의 중복도가 낮은 Column

### 인덱스 사용을 피해야 하는 경우

- 데이터의 중복도가 낮은 Column
- DML이 자주 일어나는 Column

## 인덱스의 관리

DBMS는 Index를 항상 최신의 상태로 유지해야지 원하는 값을 빠르게 탐색할 수 있다. 그래서 인덱스가 적용된 Column에 Insert, Update, Delete 쿼리가 수행된다면 각각 아래와 같은 연산을 해줘야한다.

> Index관련 추가적인 작업을 하기에 그만큼 오버헤드가 발생한다
>
- Insert: 새로운 데이터에 대한 인덱스를 추가한다.
    - 기존 Block에 여유가 없을 때, 새로운 Block을 할당 받은 후, Key를 옮기는 작업을 수행한다.
- Update: 기존의 인덱스를 사용하지 않음 처리하고, 갱신된 데이터에 대해 인덱스를 추가한다.
    - 테이블에서 업데이트가 발생하면 인덱스는 업데이트 할 수 없다. 그래서 인덱스에스는 Delete를 발생시킨 후, 새로운 작업의 Insert작업을 진행하여 2배의 작업이 소요된다.
- Delete: 삭제하는 데이터의 인덱스를 사용하지 않는다는 작업을 진행한다.
    - Table에서 data가 delete 되는 경우 : Data가 지워지고, 다른 Data가 그 공간을 사용 가능하다
    - Index에서 Data가 delete 되는 경우 : Data가 지워지지 않고, 사용 안 됨 표시만 해둔다.
    - 그래서 Table의 Data 수와 Index의 Data 수가 다를 수 있다.
